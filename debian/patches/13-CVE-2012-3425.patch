 pngpread.c |    7 +++++++
 1 file changed, 7 insertions(+)

Index: libpng-1.2.47/pngpread.c
===================================================================
--- libpng-1.2.47.orig/pngpread.c	2012-04-08 20:44:37.000000000 +0200
+++ libpng-1.2.47/pngpread.c	2012-04-08 20:47:17.000000000 +0200
@@ -1380,6 +1380,13 @@ png_push_read_zTXt(png_structp png_ptr,
 
       text++;
 
+      if (text >= key + png_ptr->current_text_size)
+      {
+         png_ptr->current_text = NULL;
+         png_free(png_ptr, key);
+         return;
+      }
+
       if (*text != PNG_TEXT_COMPRESSION_zTXt) /* Check compression byte */
       {
          png_ptr->current_text = NULL;
